<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heatmap Data Analysis</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .analysis { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        pre { background: #f8f9fa; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>LeetCode Heatmap Data Analysis</h1>
    <div id="analysis"></div>

    <script>
        async function analyzeHeatmapData() {
            const analysisDiv = document.getElementById('analysis');
            
            try {
                // Load the calendar data
                const response = await fetch('./data/leetcode-calendar.json');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const data = await response.json();
                
                // Parse the submission calendar
                const submissionCalendar = JSON.parse(data.data.submissionCalendar);
                
                // Calculate total submissions
                let totalSubmissions = 0;
                let submissionDates = [];
                
                for (const timestamp in submissionCalendar) {
                    const count = submissionCalendar[timestamp];
                    totalSubmissions += count;
                    submissionDates.push({
                        date: new Date(parseInt(timestamp) * 1000),
                        count: count,
                        timestamp: timestamp
                    });
                }
                
                // Sort by date
                submissionDates.sort((a, b) => a.date - b.date);
                
                // Find date range
                const firstDate = submissionDates[0].date;
                const lastDate = submissionDates[submissionDates.length - 1].date;
                const daysDiff = Math.floor((lastDate - firstDate) / (1000 * 60 * 60 * 24));
                
                // Current heatmap logic (210 days)
                const today = new Date();
                const days = 210; // Current limit
                let activity210 = Array(days).fill(0);
                let totalSubmissions210 = 0;
                
                for (const ts in submissionCalendar) {
                    const day = new Date(parseInt(ts, 10) * 1000);
                    const diff = Math.floor((today - day) / (1000 * 60 * 60 * 24));
                    if (diff >= 0 && diff < days) {
                        activity210[days - diff - 1] = submissionCalendar[ts];
                        totalSubmissions210 += submissionCalendar[ts];
                    }
                }
                
                // Full year analysis (365 days)
                const days365 = 365;
                let activity365 = Array(days365).fill(0);
                let totalSubmissions365 = 0;
                
                for (const ts in submissionCalendar) {
                    const day = new Date(parseInt(ts, 10) * 1000);
                    const diff = Math.floor((today - day) / (1000 * 60 * 60 * 24));
                    if (diff >= 0 && diff < days365) {
                        activity365[days365 - diff - 1] = submissionCalendar[ts];
                        totalSubmissions365 += submissionCalendar[ts];
                    }
                }
                
                analysisDiv.innerHTML = `
                    <div class="analysis">
                        <h3>üìä Submission Data Analysis</h3>
                        <p><strong>Total submissions in calendar data:</strong> ${totalSubmissions}</p>
                        <p><strong>Date range:</strong> ${firstDate.toLocaleDateString()} to ${lastDate.toLocaleDateString()} (${daysDiff} days)</p>
                        <p><strong>Number of active days:</strong> ${submissionDates.length}</p>
                    </div>
                    
                    <div class="analysis">
                        <h3>üîç Current Heatmap Logic (210 days)</h3>
                        <p><strong>Submissions in last 210 days:</strong> ${totalSubmissions210}</p>
                        <p><strong>Active days in last 210 days:</strong> ${activity210.filter(d => d > 0).length}</p>
                    </div>
                    
                    <div class="analysis">
                        <h3>üìÖ Full Year Analysis (365 days)</h3>
                        <p><strong>Submissions in last 365 days:</strong> ${totalSubmissions365}</p>
                        <p><strong>Active days in last 365 days:</strong> ${activity365.filter(d => d > 0).length}</p>
                    </div>
                    
                    <div class="analysis">
                        <h3>üìà Recent Activity (Last 30 days)</h3>
                        <p><strong>Submissions in last 30 days:</strong> ${activity365.slice(-30).reduce((a, b) => a + b, 0)}</p>
                        <p><strong>Active days in last 30 days:</strong> ${activity365.slice(-30).filter(d => d > 0).length}</p>
                    </div>
                    
                    <div class="analysis">
                        <h3>üîß Recommendation</h3>
                        <p>The heatmap should be updated to show a full year (365 days) instead of just 210 days to capture all your submissions.</p>
                        <p>Current: ${totalSubmissions210} submissions in 210 days</p>
                        <p>Full year: ${totalSubmissions365} submissions in 365 days</p>
                    </div>
                `;
                
            } catch (error) {
                analysisDiv.innerHTML = `
                    <div class="analysis" style="background-color: #f8d7da; border-color: #f5c6cb;">
                        <h3>‚ùå Error</h3>
                        <p>Failed to load data: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Run the analysis
        analyzeHeatmapData();
    </script>
</body>
</html>
